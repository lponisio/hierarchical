\documentclass[12pt]{article}
\usepackage[top=0.85in, bottom=0.93in, right=0.93in, left=0.93in,
paperwidth=8.5in, paperheight=11in, nohead]{geometry}
\geometry{letterpaper}
\usepackage[pdftex]{graphicx}
\usepackage{color}
\usepackage[normalem]{ulem}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{epstopdf}
\usepackage{setspace}
\usepackage{mdwlist}
\usepackage{verbatim}
\usepackage{tikz}
\usepackage[numbers]{natbib}

%% make bibliography more compact \setlength{\bibsep}{0in}
\renewcommand\bibsection{\subsubsection*{\refname}}

\begin{document}

\begin{centering}
  \large {\bf Occupancy models with NIMBLE} \\
\end{centering}
\vspace{0.15in}


\section{Goals}
\begin{enumerate}
\item Showcase the functionality/efficiency of NIMBLE using occupancy
  modeling
\item provide code online and as supplement for common occupancy
  models (and a tutorial?)
\item target journal: \textit{Methods in Ecology and Evolution}
\end{enumerate}


\section{Models}
\begin{enumerate}
\item Multi-season occupancy model
  \begin{enumerate}
  \item vectorize Bernoulli call \checkmark
  \item write a user-defined MCMC for the Zs, slice sampler for other
    parameters \checkmark
  \item custom z sampelr and auto blocking for other paramters
    \checkmark
  \item add reflective samplers for bounded parameters, and custom z
    sampler \checkmark
  \item write function for latent state (Zs) likelihood \checkmark
  \item write function for latent state (Zs) likelihood with auto
    blocking \checkmark
  \item sample uniforms on logit scale?
  \item cross level sampling?
  \end{enumerate}
\item Multi-species occupancy model (from Zipkin et al.)
  \begin{enumerate}
  \item write function for latent state (Zs) likelihood \checkmark
  \item block samplers for species random effect for each type \checkmark
  \item block samplers for species random effect for each species
    across types \checkmark
  \item for all above, compute ``derived quantities'' as posterior
    sample of probabilities vs. posterior sample of binomial samples
    of the posterior probabilities \checkmark (now removed from
    efficiency calculation)
  \end{enumerate}
\item Spatial occupancy model (CAR model or distance decay)
  \begin{enumerate}
  \item have to implement the model
  \item auto-blocking of parameters related to decay with distance
  \end{enumerate}
\end{enumerate}

\section{Comparisons}
\begin{enumerate}
\item original single species, multi season model to 1) vectorized
  Bernoulli draw, 2) custom z sampler with slice sampler on other
  parameters, 3) custom z sampler with auto blocker on other
  paramters, 4) custom z sampler with reflective sampler on other
  parameters, 5) explicit likelihood for latent state, 6) explicit
  likelihood for latent state and auto blocking
\item original multi species, single season model to 1) explicit
  likelihood for latent state with vectorized calculations and
  expected values of derived quantities, 2) all the same but with
  block sampling of the species random effects
\end{enumerate}

\section{Results}
\subsection{Single species, multi season}
\begin{enumerate}
\item JAGS and NIMBLE tie on the multi season model when the slice
  sampler and custom z sampler are used (same samplers as JAGS)
\item For the run with custom z on the zs and slice samplers on the
  uniform(0,1)s, copying takes about $10\%$ of total time.
\item For the run with custom z on the zs and default RW samplers on
  the uniform(0,1)s, copying takes a bit over $20\%$ of total time.
\item So not trivial, but also not something that if improved would
  cause a huge jump in performance.  Improvements from algorithmic
  insights have potential for big jumps.
\end{enumerate}

\section{Considerations}
\begin{enumerate}
\item Daniel just modified MCMCsuite() to allow a skip check argument
  to allow user-defined functions with dimension ``mismatches'' to
  pass the check \checkmark
\item try MCMCsuite() with user function with and without check
\item compareMCMC() is a new function, see Perry tutorial for an
  example (make sure summary=FALSE to allow for further comparisons)
\end{enumerate}

\section{Misc. notes}
\begin{enumerate}
\item copy issue in nimble:  In Jags each step always updates, whereas
  in NIMBLE certain proposals can be rejected. This enables NIMBLE to
  be more flexible about MCMC samplers (for example, Metropolis
  Hastings) but means NIMBLE has to copy more. If the proposal is
  rejected the original is copied to the next step. If the proposal is
  accepted, the new value because the original for the next step.
\item thinning may ''hurt'' samples that are mixing well. In contrast,
  a poorly mixing sampler will be ``helped'' because tinning helps is
  ``mix better''
\item reflective samplers and bounded parameters: Reflective samplers
  might be most helpful when the posterior is skewed. In that case,
  the sampler would reject more often near the boundaries in the
  non-reflective case, so it may take longer to converge on the
  correct, skewed posterior. In constrast, when the posterior is not
  skewed, it may not matter as much because the sampler will spend
  less time at the doundaries.
\end{enumerate}


\section{Future directions}
\begin{enumerate}
\item ``parametric bootstrapping'' for model evaluation, calibrated
  pvalues
\item avoiding the data augmentation BUGS work around paper
\end{enumerate}


\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-PDF-mode: t
%%% End:


